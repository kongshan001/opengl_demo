# 开发进度

本文档记录项目的开发进度和已完成的需求。

## 当前状态

- **最后更新**: 2026-02-22
- **开发阶段**: 活跃迭代中
- **Git 分支**: main
- **总需求**: 24+
- **已完成**: 15+

## 完成需求列表

### 光照系统 (REQ-016 ~ REQ-018)

#### REQ-016: Phong 光照模型 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 实现完整的 Phong 光照（环境光、漫反射、镜面反射）

**实现内容**:
- 创建 phong.fs 着色器
- 添加 Material 结构体 uniform（ambient, diffuse, specular, shininess）
- 添加 Light 结构体 uniform（position, color, ambientStrength, diffuseStrength, specularStrength）
- 为每个几何体设置不同的材质属性
- 22 个相关测试全部通过

**效果**:
- 立方体：平面高光，不同面有不同亮度
- 球体：连续的高光带，明暗渐变
- 圆柱体和圆锥体：曲面上呈现高光
- 地面：低镜面反射，哑光效果

#### REQ-017: 动态光源 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 光源围绕场景旋转动画

**实现内容**:
- 光源围绕场景圆形轨道旋转
- 添加 L 键切换光源动画开关
- 可配置轨道半径、高度、速度
- 更新 README 控制说明

**效果**: 光源在 XZ 平面圆形轨道上移动，Y 轴高度固定

#### REQ-018: 多光源支持 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 支持多个点光源和距离衰减

**实现内容**:
- 创建 multi_light.fs 多光源着色器
- 支持 4 个点光源同时照射
- 实现距离衰减 (constant/linear/quadratic)
- 3 个不同颜色的光源 (白/蓝/橙)
- 各光源独立轨道旋转动画
- 更新 README 光源说明

**效果**: 多个光源同时照射，颜色混合，距离越远越暗

### UI 和交互 (REQ-019 ~ REQ-020)

#### REQ-019: 键盘快捷键改进 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 改进键盘输入处理

**实现内容**:
- 数字键使用按键释放检测，避免连续触发
- 添加 F1 帮助显示（控制台输出）
- 更新 README 添加 F1 说明

#### REQ-020: ImGui 调试界面 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 添加 ImGui 实时调试界面

**实现内容**:
- 集成 Dear ImGui (docking 分支)
- 添加性能统计窗口（FPS、帧时间）
- 添加光源控制窗口（实时调整参数）
- 添加菜单栏（窗口和显示菜单）
- Tab 键切换 UI 显示
- 使用 FetchContent 自动下载 ImGui

**窗口列表**:
- 性能统计：FPS、帧时间、对象数、剔除率
- 光源控制：颜色、位置、轨道参数
- 纹理控制：纹理开关和参数

### 几何体和纹理 (REQ-021 ~ REQ-022)

#### REQ-021: 新几何体 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 添加更多几何体

**实现内容**:
- MeshUtils::createTorus() - 圆环生成
- MeshUtils::createCapsule() - 胶囊体生成
- 支持自定义半径、高度、细分段数
- 正确的法线和纹理坐标计算

#### REQ-022: 多纹理支持 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 支持多纹理贴图

**实现内容**:
- multi_light.fs 支持漫反射、镜面反射、法线贴图
- Application 加载镜面反射纹理
- 添加纹理控制 ImGui 窗口
- 支持 3 个纹理单元（TEXTURE0-2）
- 镜面反射强度可纹理控制

### 场景管理 (REQ-023)

#### REQ-023: 场景序列化 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 保存和加载场景配置

**实现内容**:
- 创建 SceneSerializer 类处理 JSON 序列化
- 支持保存/加载场景配置（光源、显示、摄像机）
- 添加 nlohmann/json 依赖
- Ctrl+S 保存场景
- Ctrl+O 加载场景
- 文件菜单支持保存/加载/退出

### 性能优化 (REQ-024)

#### REQ-024: 视锥体剔除 ✅
**状态**: 已完成 (2026-02-22)
**描述**: 实现视锥体剔除优化

**实现内容**:
- 添加 Frustum 类处理视锥体计算
- 支持 AABB 包围盒剔除
- 实时统计剔除率和性能数据
- ImGui 中显示剔除统计
- 可开关视锥体剔除功能

**效果**: 不在视锥体内的物体不进行渲染，提升性能

### 基础功能 (REQ-001 ~ REQ-015)

#### REQ-001 ~ REQ-015: 基础迭代 ✅
**状态**: 已完成 (2026-02-20 ~ 2026-02-21)
**描述**: 基础功能和多角色协作

**主要功能**:
- 纹理立方体渲染
- 键盘 WASD+QE 移动
- 鼠标视角旋转
- FPS 显示
- 多个立方体
- 地面平面
- 暂停/继续
- 重置摄像机
- 圆柱体和圆锥体
- 显示模式切换
- 线框模式
- 控制说明

**技术改进**:
- 多角色协作系统
- 完善的错误处理
- 智能指针使用
- Uniform location 缓存
- API 文档完善

## 技术栈

### 核心技术

| 类别 | 技术 |
|------|------|
| 渲染 API | OpenGL 3.3 Core Profile |
| 窗口管理 | GLFW 3.3.8 |
| OpenGL 加载 | GLAD |
| 数学库 | GLM 0.9.9.8 |
| 构建系统 | CMake 3.10+ |
| 测试框架 | Google Test |
| 图像加载 | stb_image |

### 新增技术 (2026-02-22)

| 技术 | 用途 |
|------|------|
| nlohmann/json | JSON 序列化 |
| Dear ImGui | 调试界面（docking 分支） |
| multi_light.fs | 多光源着色器 |
| Frustum 类 | 视锥体计算和剔除 |

## 项目统计

### 代码量

- 头文件: ~2000 行
- 源文件: ~3000 行
- 着色器: ~500 行
- 测试: ~2000 行

### 测试覆盖

- 单元测试: 103+
- 测试通过率: 100%

### Git 提交

- 总提交数: 25+
- 今日提交数: 9

## 版本历史

### v0.1.0 (2026-02-20)
- 基础 OpenGL 框架
- 网格渲染
- 基础着色器
- 模型加载

### v0.2.0 (2026-02-21)
- 键盘控制
- 鼠标控制
- FPS 显示
- 多种几何体
- 场景管理

### v0.3.0 (2026-02-22)
- 完整 Phong 光照
- 多光源系统
- ImGui 界面
- 场景序列化
- 视锥体剔除
